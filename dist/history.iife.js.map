{"version":3,"file":"history.iife.js","sources":["../source/common/is.js","../source/browser/events/polyfill.js","../source/browser/events/index.js","../source/index.js"],"sourcesContent":["/**\n * @name is\n *\n * @description\n * Test if `value` is a type of `type`.\n *\n * @param {Mixed} value value to test.\n * @param {String} expectedType type waited.\n *\n * @return {Boolean} true if `value` is a type of `type`, false otherwise.\n *\n * @private\n`*/\nexport default function is(expected, value) {\n\treturn new RegExp(`(${expected})`).test(toString.call(value));\n}\n","/**\n * Browser events polyfill\n * @module browser/events/polyfill\n */\n\n/**\n * @name createEvent\n *\n * @description\n * Creates an event of the type specified. The returned object should be first\n * initialized and can then be passed to `element.dispatchEvent`.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n * Possible event types include \"UIEvents\", \"MouseEvents\", \"MutationEvents\",\n * and \"HTMLEvents\".\n *\n * @api public\n`*/\nexport function createEvent(type, options) {\n\tlet event = { type };\n\tconst opts = Object.assign({ bubbles: false, cancelable: false }, options);\n\tif (document.createEvent) {\n\t\tevent = document.createEvent('HTMLEvents');\n\t\tevent.initEvent(type, opts.bubbles, opts.cancelable);\n\t\tevent.detail = opts.detail;\n\t\treturn event;\n\t} else if (document.createEventObject) {\n\t\tevent = document.createEventObject();\n\t\tevent.eventType = type;\n\t\tevent.type = type;\n\t}\n\treturn Object.assign(event, opts);\n}\n\n/**\n * @name addEventListener\n *\n * @description\n * The EventTarget.addEventListener() method adds the specified EventListener-compatible\n * object to the list of event listeners for the specified event type on the EventTarget\n * on which it's called. The event target may be an Element in a document, the Document\n * itself, a Window, or any other object that supports events (such as XMLHttpRequest).\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n *\n * @param {Function} listener The listener function that processes the event.\n * This function must accept an Event object as its only parameter and must return nothing.\n *\n * @param {Object} options An options object that specifies characteristics about the event\n * listener.\n *\n * @param {Boolean} useCapture Determines whether the listener works in the capture phase or\n * the target and bubbling phases. If useCapture is set to true, the listener processes the\n * event only during the capture phase and not in the target or bubbling phase.\n * If useCapture is false, the listener processes the event only during the target or bubbling\n * phase.\n * To listen for the event in all three phases, call addEventListener twice, once\n * with useCapture set to true, then again with useCapture set to false.\n *\n * @api public\n`*/\nexport function addEventListener(domEl, type, listener, ...options) {\n\tif (domEl.addEventListener) {\n\t\tdomEl.addEventListener(type, listener, ...options);\n\t} else if (domEl.attachEvent && window.htmlEvents[`on${type}`]) {\n\t\tdomEl.attachEvent(`on${type}`, listener);\n\t} else {\n\t\tdomEl[`on${type}`] = listener;\n\t}\n}\n\n/**\n * @name removeEventListener\n *\n * @description\n * The EventTarget.removeEventListener() method removes from the EventTarget an event\n * listener previously registered with EventTarget.addEventListener(). The event\n * listener to be removed is identified using a combination of the event type, the\n * event listener function itself, and various optional options that may affect the\n * matching process; see Matching event listeners for removal.\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n *\n * @param {Function} listener The listener function that processes the event.\n * This function must accept an Event object as its only parameter and must return nothing.\n *\n * @param {Object} options An options object that specifies characteristics about the event\n * listener.\n *\n * @param {Boolean} useCapture Determines whether the listener works in the capture phase or\n * the target and bubbling phases. If useCapture is set to true, the listener processes the\n * event only during the capture phase and not in the target or bubbling phase.\n * If useCapture is false, the listener processes the event only during the target or\n * bubbling phase.\n * To listen for the event in all three phases, call addEventListener twice, once with useCapture\n * set to true, then again with useCapture set to false.\n *\n * @api public\n`*/\nexport function removeEventListener(domEl, type, listener, ...options) {\n\tif (domEl.removeEventListener) {\n\t\tdomEl.removeEventListener(type, listener, ...options);\n\t} else if (domEl.detachEvent && window.htmlEvents[`on${type}`]) {\n\t\tdomEl.detachEvent(`on${type}`, listener);\n\t} else {\n\t\tdomEl[`on${type}`] = null;\n\t}\n}\n\n/**\n * @name dispatchEvent\n *\n * @description\n * Dispatches an Event at the specified EventTarget, invoking the affected EventListeners\n * in the appropriate order. The normal event processing rules (including the capturing\n * and optional bubbling phase) also apply to events dispatched manually with\n * dispatchEvent().\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n *\n * @param {Mixed} options\n *\n * @returns {Boolean} cancelled Indicating whether the event was canceled\n * by an event handler.\n *\n * @api public\n`*/\nexport function dispatchEvent(domEl, type, options) {\n\tlet cancelled;\n\tconst event = createEvent(type, options);\n\tif (domEl.dispatchEvent) {\n\t\tcancelled = domEl.dispatchEvent(event);\n\t} else if (domEl.fireEvent && window.htmlEvents[`on${event.type}`]) {\n\t\tcancelled = domEl.fireEvent(`on${event.type}`, event);\n\t} else if (domEl[`on${event.type}`]) {\n\t\tcancelled = domEl[`on${event.type}`](event);\n\t}\n\treturn typeof cancelled === 'undefined' || cancelled;\n}\n","/**\n * Browser events\n * @module browser/events\n * @exports browser/events\n * @alias module:browser/events\n */\n\nimport is from '../../common/is';\nimport * as polyfill from './polyfill';\n\n/**\n * @name events\n *\n * @description\n * A collection of events.\n *\n * @private\n`*/\nconst events = [];\n\n/**\n * @name emit\n *\n * @description\n * Execute all handlers and behaviors attached to the matched elements\n * for the given event type.\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} name The type is the name of Event object to be dispatched.\n *\n * @param {Mixed} options\n *\n * @api public\n`*/\nexport function emit(domEl, name, options) {\n\tlet cancelled = false;\n\tconst numArgs = arguments.length;\n\tconst types = String(name).split(' ');\n\tconst numTypes = types.length;\n\tconst domIsAnEventType = is('String', domEl);\n\tfor (let ix = 0; ix < numTypes; ix += 1) {\n\t\tconst type = types[ix];\n\t\tif (numArgs <= 1 || domIsAnEventType) {\n\t\t\tconst dispatched = [];\n\t\t\tfor (let id = events.length - 1; id >= 0; id -= 1) {\n\t\t\t\tconst event = events[id];\n\t\t\t\tconst eventType = numArgs ? domEl : event.type;\n\t\t\t\tdispatched.push(polyfill.dispatchEvent(event.domEl, eventType, options));\n\t\t\t}\n\t\t\treturn dispatched;\n\t\t}\n\t\tif (polyfill.dispatchEvent(domEl, type, options)) {\n\t\t\tcancelled = true;\n\t\t}\n\t}\n\treturn cancelled;\n}\n\n/**\n * @name on\n *\n * @description\n * Attach an event handler function for one or more events to the\n * selected elements.\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} name The type is the name of Event object to be dispatched.\n *\n * @param {Function} listener The listener function that processes the event.\n * This function must accept an Event object as its only parameter and must return nothing.\n *\n * @param {Object} options An options object that specifies characteristics about the\n * event listener.\n *\n * @param {Boolean} useCapture Determines whether the listener works in the capture phase or\n * the target and bubbling phases. If useCapture is set to true, the listener processes the\n * event only during the capture phase and not in the target or bubbling phase.\n * If useCapture is false, the listener processes the event only during the target or\n * bubbling phase.\n * To listen for the event in all three phases, call addEventListener twice, once\n * with useCapture set to true, then again with useCapture set to false.\n *\n * @api public\n`*/\nexport function on(domEl, name, listener, ...options) {\n\tconst types = String(name).split(' ');\n\tfor (let ix = types.length - 1; ix >= 0; ix -= 1) {\n\t\tconst type = types[ix];\n\t\tfor (let iy = events.length - 1; iy >= 0; iy -= 1) {\n\t\t\tconst event = events[iy];\n\t\t\tif (event.type === type && event.listener === listener) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tpolyfill.addEventListener(domEl, type, listener, ...options);\n\t\tevents.push({ domEl, type, listener });\n\t}\n}\n\n/**\n * @name off\n *\n * @description\n * Remove event handler(s) from element(s).\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} name The type is the name of Event object to be dispatched.\n *\n * @param {Function} listener The listener function that processes the event.\n * This function must accept an Event object as its only parameter and must return nothing.\n *\n * @param {Object} options An options object that specifies characteristics about the\n * event listener.\n *\n * @param {Boolean} useCapture Determines whether the listener works in the capture phase or\n * the target and bubbling phases. If useCapture is set to true, the listener processes the\n * event only during the capture phase and not in the target or bubbling phase.\n * If useCapture is false, the listener processes the event only during the target or\n * bubbling phase.\n * To listen for the event in all three phases, call addEventListener twice, once\n * with useCapture set to true, then again with useCapture set to false.\n *\n * @api public\n`*/\nexport function off(domEl, name, listener, ...options) {\n\tconst types = String(name).split(' ');\n\tconst numArgs = arguments.length;\n\tconst domIsAnEventType = is('String', domEl);\n\tfor (let ix = types.length - 1; ix >= 0; ix -= 1) {\n\t\tconst type = types[ix];\n\t\tconst eventType = domIsAnEventType ? domEl : type;\n\t\tfor (let iy = events.length - 1; iy >= 0; iy -= 1) {\n\t\t\tconst event = events[iy];\n\t\t\tconst allElements = numArgs <= 1;\n\t\t\tconst hasSameType = numArgs > 1 && event.type === eventType;\n\t\t\tconst isSameEvent = numArgs > 2 && event.listener === listener && hasSameType;\n\t\t\tif (allElements) {\n\t\t\t\tevent.type = domIsAnEventType ? eventType : event.type;\n\t\t\t\tpolyfill.removeEventListener(event.domEl, event.type, event.listener, ...options);\n\t\t\t\tevents.splice(iy, 1);\n\t\t\t} else if (hasSameType || isSameEvent) {\n\t\t\t\tpolyfill.removeEventListener(domEl, eventType, event.listener, ...options);\n\t\t\t\tevents.splice(iy, 1);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * @name one\n *\n * @description\n * Attach a handler to an event for the elements. The handler is executed at most one\n * per element per event type.\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} name The type is the name of Event object to be dispatched.\n *\n * @param {Function} listener The listener function that processes the event.\n * This function must accept an Event object as its only parameter and must return nothing.\n *\n * @param {Object} options An options object that specifies characteristics about the\n * event listener.\n *\n * @param {Boolean} useCapture Determines whether the listener works in the capture phase or\n * the target and bubbling phases. If useCapture is set to true, the listener processes the\n * event only during the capture phase and not in the target or bubbling phase.\n * If useCapture is false, the listener processes the event only during the target or\n * bubbling phase.\n * To listen for the event in all three phases, call addEventListener twice, once\n * with useCapture set to true, then again with useCapture set to false.\n *\n * @api public\n`*/\nexport function one(domEl, name, listener, ...options) {\n\ton(domEl, name, function handler(event) {\n\t\toff(domEl, name, handler, ...options);\n\t\tlistener(event);\n\t}, ...options);\n}\n\n/**\n * @name hasEvent\n *\n * @description\n * Checks whether the `dom-event-dispatcher` object has any listeners registered for a specific\n * type of event. This allows you to determine where an `dom-event-dispatcher` object has altered\n * handling of an event type in the event flow hierarchy. To determine whether a specific event\n * type actually triggers an event listener, use `willEmit()`.\n *\n * The difference between `hasEvent()` and `willEmit()` is that `hasEvent()` examines only the\n * object to which it belongs, whereas `willEmit()` examines the entire event flow for the event\n * specified by the `type` parameter.\n *\n * @param {HTMLElement} domEl The target object for events dispatched to the EventTarget object.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n *\n * @returns {Boolean} A value of `true` if a listener of the specified type is registered;\n * `false` otherwise.\n *\n * @api public\n`*/\nexport function hasEvent(domEl, name) {\n\tconst types = String(name).split(' ');\n\tfor (let ix = types.length - 1; ix >= 0; ix -= 1) {\n\t\tconst type = types[ix];\n\t\tfor (let iy = events.length - 1; iy >= 0; iy -= 1) {\n\t\t\tconst event = events[iy];\n\t\t\tif (event.domEl === domEl && event.type === type) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * @name willEmit\n *\n * @description\n * Checks whether an event listener is registered with this `dom-event-dispatcher` object or\n * any of its ancestors for the specified event type. This method returns `true` if an event\n * listener is triggered during any phase of the event flow when an event of the specified\n * type is dispatched to this `dom-event-dispatcher` object or any of its descendants.\n *\n * The difference between the `hasEvent()` and the `willEmit()` methods is that `hasEvent()`\n * examines only the object to which it belongs, whereas the `willEmit()` method examines\n * the entire event flow for the event specified by the type parameter.\n *\n * @param {String} type The type is the name of Event object to be dispatched.\n *\n * @returns {Boolean} A value of `true` if a listener of the specified type is registered;\n * `false` otherwise.\n *\n * @api public\n`*/\nexport function willEmit(name) {\n\tconst types = String(name).split(' ');\n\tfor (let ix = types.length - 1; ix >= 0; ix -= 1) {\n\t\tconst type = types[ix];\n\t\tfor (let iy = events.length - 1; iy >= 0; iy -= 1) {\n\t\t\tif (events[iy].type === type) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n","import * as dispatcher from './browser/events/index';\n\nconst pirate = {};\nconst ua = navigator.userAgent;\nconst HashChangeEvent = 'hashchange';\nconst HashChangeHook = `on${HashChangeEvent}`;\nconst PopStateEvent = 'popstate';\nconst PopStateHook = `on${PopStateEvent}`;\nconst ReplaceStateEvent = 'replacestate';\nconst ChangeStateEvent = 'changestate';\nconst PushStateEvent = 'pushstate';\n\nfunction shouldEmitPopStateEvent(event) {\n\tconst isChromeFromIOS = ua.indexOf('CriOS') > -1;\n\tconst hasState = typeof event.state !== 'undefined';\n\treturn hasState || isChromeFromIOS;\n}\n\nfunction emitCallbackEvent(callback, event) {\n\tObject.defineProperty(event, 'currentTarget', {\n\t\tget: function getCurrentTarget() {\n\t\t\treturn pirate;\n\t\t},\n\t});\n\tif (typeof callback === 'function') {\n\t\tcallback.call(pirate, event);\n\t}\n}\n\nfunction emitPopStateEvent(callback, state) {\n\temitCallbackEvent(callback, state);\n\tpirate.emit(ChangeStateEvent, state);\n}\n\nfunction onPopState(callback) {\n\treturn function onpopstate(event) {\n\t\tif (shouldEmitPopStateEvent(event)) {\n\t\t\temitPopStateEvent(callback, event);\n\t\t}\n\t};\n}\n\nfunction onHashChange(callback) {\n\treturn function onhashchange() {\n\t\temitPopStateEvent(callback, pirate);\n\t};\n}\n\nObject.defineProperty(pirate, HashChangeHook, {\n\tset: function setOnHashChange(val) {\n\t\tif (!val) pirate.off(HashChangeEvent);\n\t\tpirate.on(HashChangeEvent, onHashChange(val));\n\t},\n\tget: function getOnHashChange() {\n\t\treturn window[HashChangeHook];\n\t},\n});\n\nObject.defineProperty(pirate, PopStateHook, {\n\tset: function setOnPopState(val) {\n\t\tif (!val) pirate.off(PopStateEvent);\n\t\tpirate.on(PopStateEvent, onPopState(val));\n\t},\n\tget: function getOnPopState() {\n\t\treturn window[PopStateHook];\n\t},\n});\n\nObject.defineProperty(pirate, 'length', {\n\tset: function setLength(val) {\n\t\twindow.history.length = val;\n\t},\n\tget: function getLength() {\n\t\treturn window.history.length;\n\t},\n});\n\nObject.defineProperty(pirate, 'state', {\n\tget: function getState() {\n\t\tconst pirateState = {};\n\t\ttry {\n\t\t\treturn window.history.state || pirateState;\n\t\t} catch (err) { return pirateState; }\n\t},\n});\n\nObject.defineProperty(pirate, 'hasStateList', {\n\tget: function hasStateList() {\n\t\treturn /Chrome|Windows\\sPhone/.test(ua) &&\n\t\t!/Mobile\\sSafari|Android\\s(2\\..+|4\\.0)/g.test(ua) &&\n\t\twindow.history && 'pushState' in window.history;\n\t},\n});\n\nObject.defineProperty(pirate, 'HashChangeEvent', {\n\tget: function getHashChangeEvent() {\n\t\treturn HashChangeEvent;\n\t},\n});\n\nObject.defineProperty(pirate, 'HashChangeHook', {\n\tget: function getHashChangeHook() {\n\t\treturn HashChangeHook;\n\t},\n});\n\nObject.defineProperty(pirate, 'PopStateEvent', {\n\tget: function getPopStateEvent() {\n\t\treturn PopStateEvent;\n\t},\n});\n\nObject.defineProperty(pirate, 'PopStateHook', {\n\tget: function getPopStateHook() {\n\t\treturn PopStateHook;\n\t},\n});\n\nObject.defineProperty(pirate, 'ReplaceStateEvent', {\n\tget: function getPopStateHook() {\n\t\treturn ReplaceStateEvent;\n\t},\n});\n\nObject.defineProperty(pirate, 'ChangeStateEvent', {\n\tget: function getPopStateHook() {\n\t\treturn ChangeStateEvent;\n\t},\n});\n\nObject.defineProperty(pirate, 'PushStateEvent', {\n\tget: function getPopStateHook() {\n\t\treturn PushStateEvent;\n\t},\n});\n\npirate.on = function on(type, listener, options) {\n\tdispatcher.on(window, type, listener, options);\n};\n\npirate.one = function one(type, listener, options) {\n\treturn dispatcher.one(window, type, listener, options);\n};\n\npirate.off = function off(type, listener, options) {\n\tdispatcher.off(window, event.type, event.listener, options);\n};\n\npirate.emit = function emit(type, state) {\n\treturn dispatcher.emit(window, type, { bubbles: true, cancelable: true, detail: { state } });\n};\n\npirate.willEmit = function willEmit(type) {\n\treturn dispatcher.willEmit(type);\n};\n\npirate.pushState = function pushState(state, title, url) {\n\tconst response = window.history.pushState(state, title, url);\n\tpirate.emit(PushStateEvent, state);\n\tpirate.emit(ChangeStateEvent, state);\n\treturn response;\n};\n\npirate.replaceState = function replaceState(state, title, url) {\n\tconst response = window.history.replaceState(state, title, url);\n\tpirate.emit(ReplaceStateEvent, state);\n\tpirate.emit(ChangeStateEvent, state);\n\treturn response;\n};\n\npirate.go = function go(factor) {\n\treturn window.history.go(factor);\n};\n\npirate.forward = function forward() {\n\treturn window.history.forward();\n};\n\npirate.back = function back() {\n\treturn window.history.back();\n};\n\nexport default pirate;\n"],"names":["is","expected","value","RegExp","test","toString","call","createEvent","type","options","event","opts","Object","assign","bubbles","cancelable","document","initEvent","detail","createEventObject","eventType","addEventListener","domEl","listener","attachEvent","window","htmlEvents","removeEventListener","detachEvent","dispatchEvent","cancelled","fireEvent","events","emit","name","numArgs","arguments","length","types","String","split","numTypes","domIsAnEventType","ix","dispatched","id","push","polyfill","on","iy","off","allElements","hasSameType","isSameEvent","splice","one","handler","willEmit","pirate","ua","navigator","userAgent","HashChangeEvent","HashChangeHook","PopStateEvent","PopStateHook","ReplaceStateEvent","ChangeStateEvent","PushStateEvent","shouldEmitPopStateEvent","isChromeFromIOS","indexOf","hasState","state","emitCallbackEvent","callback","defineProperty","get","getCurrentTarget","emitPopStateEvent","onPopState","onpopstate","onHashChange","onhashchange","set","setOnHashChange","val","getOnHashChange","setOnPopState","getOnPopState","setLength","history","getLength","getState","pirateState","err","hasStateList","getHashChangeEvent","getHashChangeHook","getPopStateEvent","getPopStateHook","dispatcher","pushState","title","url","response","replaceState","go","factor","forward","back"],"mappings":"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"}